OASISFormat:    0.4
OCamlVersion:   >= 4.02
Name:           webtest
Version:        1.0.2
Authors:        John Else
License:        MIT
Synopsis:       Unit test framework fully compatible with js_of_ocaml
Plugins:        META (0.4), DevFiles (0.4)
BuildTools:     ocamlbuild

PostCleanCommand:   rm -f test/run_tests_browser.js

Library webtest
  Path:               lib
  Pack:               true
  InternalModules:    Suite, Utils, Zipper

Library webtest_js
  Path:               js
  Pack:               true
  BuildDepends:       js_of_ocaml, js_of_ocaml.ppx, webtest
  Findlibname:        js
  Findlibparent:      webtest
  InternalModules:    Runner

Executable run_tests_browser
  Build$:             flag(tests)
  CompiledObject:     byte
  Path:               test
  MainIs:             run_tests_browser.ml
  BuildDepends:       js_of_ocaml, js_of_ocaml.ppx, webtest, webtest.js
  Install:            false

Test run_tests_browser
  PreCommand:         js_of_ocaml run_tests_browser.byte -o test/run_tests_browser.js
  Command:            test/test_driver.py
  Run$:               flag(tests)

Executable run_tests_ocaml
  Build$:             flag(tests)
  CompiledObject:     best
  Path:               test
  MainIs:             run_tests_ocaml.ml
  BuildDepends:       webtest
  Install:            false

Test run_tests_ocaml
  Command:            ./run_tests_ocaml.native
  Run$:               flag(tests)

Document webtest_api
  Type:         Custom (0.4)
  Title:        Unit test framework fully compatible with js_of_ocaml
  XCustom:      mkdir -p ./doc && ocaml contrib/pack.ml -o doc/webtest.ml -no-ml -mli lib/suite.mli lib/zipper.mli lib/utils.mli && ocaml contrib/pack.ml -o doc/webtest_js.ml -no-ml -mli js/runner.mli && ocamlbuild -build-dir '_build' -docflags '-t Webtest -colorize-code -short-functors -charset utf-8' webtest_api.docdir/index.html && ln -sf _build/webtest_api.docdir webtest_api.docdir
  XCustomClean: rm -rf ./doc && rm -f ./webtest_api.docdir
  Install:      false
